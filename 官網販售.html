<!doctype html>
<html lang="zh-Hant-TW">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>貝樂創意工作室｜專業汽車LED大燈</title>
  <meta name="description" content="貝樂創意工作室｜專業汽車LED大燈。付款：✅轉帳（可用），⚠️藍新科技支付（申請中）。客服：bryan.deng1224@gmail.com / 0980-556-730｜統編：93415481" />
  <meta name="theme-color" content="#070A12" />

  <style>
    :root{
      --bg0:#05060B;
      --bg1:#070A12;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.08);
      --line: rgba(255,255,255,.10);
      --text: rgba(246,250,255,.92);
      --muted: rgba(246,250,255,.70);
      --muted2: rgba(246,250,255,.55);

      --a: #7dd3fc;
      --b: #a78bfa;
      --c: #34d399;
      --w: #fbbf24;
      --r: #fb7185;

      --shadow: 0 28px 90px rgba(0,0,0,.60);
      --shadow2: 0 18px 60px rgba(0,0,0,.45);

      --radius: 22px;
      --radius2: 30px;

      --max: 1180px;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans TC","PingFang TC","Microsoft JhengHei", Arial, sans-serif;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;

      --glowA: 0 0 0 1px rgba(125,211,252,.20), 0 0 60px rgba(125,211,252,.14);
      --glowB: 0 0 0 1px rgba(167,139,250,.18), 0 0 60px rgba(167,139,250,.12);
      --glowC: 0 0 0 1px rgba(52,211,153,.18), 0 0 60px rgba(52,211,153,.12);

      --ease: cubic-bezier(.2,.9,.2,1);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 800px at 18% 10%, rgba(125,211,252,.16), transparent 55%),
        radial-gradient(1000px 700px at 82% 18%, rgba(167,139,250,.14), transparent 55%),
        radial-gradient(900px 700px at 50% 120%, rgba(52,211,153,.10), transparent 55%),
        linear-gradient(180deg, var(--bg0) 0%, var(--bg1) 38%, #04050A 100%);
      overflow-x:hidden;
    }

    a{ color:inherit; text-decoration:none; }
    button{ font-family:inherit; }
    .wrap{ max-width: var(--max); margin:0 auto; padding: 22px; }
    .sr{ position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden; }

    /* ====== Animated background canvas ====== */
    #fx{
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events:none;
      opacity: .85;
      mix-blend-mode: screen;
      filter: saturate(1.05) contrast(1.03);
    }

    /* ====== Top Nav ====== */
    .topbar{
      position: sticky;
      top:0;
      z-index: 50;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(5,6,11,.55);
      backdrop-filter: blur(14px);
    }
    .topbar .wrap{
      display:flex;
      gap:14px;
      align-items:center;
      justify-content:space-between;
    }

    .brand{
      display:flex;
      gap:12px;
      align-items:center;
      min-width: 270px;
    }
    .mark{
      width:44px; height:44px;
      border-radius: 14px;
      background:
        radial-gradient(14px 14px at 25% 30%, rgba(125,211,252,.55), transparent 60%),
        radial-gradient(20px 18px at 78% 35%, rgba(167,139,250,.45), transparent 62%),
        radial-gradient(20px 18px at 55% 78%, rgba(52,211,153,.35), transparent 62%),
        linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.02));
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: var(--shadow2);
      position:relative;
      overflow:hidden;
      isolation:isolate;
    }
    .mark:after{
      content:"";
      position:absolute;
      inset:-80%;
      background: conic-gradient(from 180deg,
        rgba(125,211,252,.0),
        rgba(125,211,252,.35),
        rgba(167,139,250,.32),
        rgba(52,211,153,.20),
        rgba(125,211,252,.0)
      );
      animation: spin 7s linear infinite;
      opacity:.9;
    }
    @keyframes spin{ to{ transform: rotate(360deg); } }

    .brand h1{
      margin:0;
      font-size: 14.5px;
      letter-spacing: .6px;
      font-weight: 950;
      line-height: 1.2;
    }
    .brand p{
      margin: 4px 0 0;
      font-size: 12px;
      color: var(--muted2);
      letter-spacing: .2px;
    }

    .nav{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      color: var(--muted);
      font-size: 12px;
    }
    .pill b{ color: var(--text); }

    .btn{
      appearance:none;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 14px;
      font-weight: 900;
      font-size: 13px;
      cursor:pointer;
      transition: transform .14s var(--ease), border-color .14s var(--ease), filter .14s var(--ease), box-shadow .14s var(--ease);
      box-shadow: 0 10px 28px rgba(0,0,0,.25);
      display:inline-flex;
      align-items:center;
      gap:10px;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(125,211,252,.35); }
    .btn:active{ transform: translateY(0); filter: brightness(.98); }
    .btn.primary{
      border-color: rgba(125,211,252,.35);
      background: linear-gradient(135deg, rgba(125,211,252,.16), rgba(167,139,250,.10));
      box-shadow: var(--glowA), 0 18px 60px rgba(0,0,0,.45);
    }
    .btn.ghost{ background: rgba(255,255,255,.03); box-shadow:none; }
    .kbd{
      font-family: var(--mono);
      font-size: 11.5px;
      padding: 2px 7px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.18);
      color: var(--text);
    }

    /* ====== Layout ====== */
    main{
      position: relative;
      z-index: 1;
    }
    .grid{
      display:grid;
      grid-template-columns: 1.26fr .74fr;
      gap: 18px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
      .brand{ min-width:auto; }
    }

    .card{
      border-radius: var(--radius2);
      border: 1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.04));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
      isolation:isolate;
    }
    .card:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(680px 260px at 18% 0%, rgba(125,211,252,.13), transparent 62%),
        radial-gradient(520px 260px at 86% 8%, rgba(167,139,250,.11), transparent 62%),
        radial-gradient(520px 260px at 60% 115%, rgba(52,211,153,.09), transparent 62%);
      pointer-events:none;
      opacity:.9;
    }

    .in{ position:relative; padding: 18px; }

    /* ====== Hero ====== */
    .hero{
      padding: 26px 22px 18px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background:
        radial-gradient(900px 360px at 12% 0%, rgba(125,211,252,.14), transparent 62%),
        radial-gradient(760px 360px at 92% 12%, rgba(167,139,250,.12), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
    }
    .heroTop{
      display:flex;
      gap: 18px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .hero h2{
      margin:0;
      font-size: 26px;
      letter-spacing:.3px;
      font-weight: 980;
      line-height: 1.18;
    }
    .hero p{
      margin: 10px 0 0;
      color: var(--muted);
      line-height: 1.7;
      font-size: 13.5px;
      max-width: 720px;
    }
    .heroBadges{
      margin-top: 14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 9px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.16);
      color: var(--muted);
      font-size: 12px;
    }
    .badge.good{ box-shadow: var(--glowC); }
    .badge.warn{ box-shadow: 0 0 0 1px rgba(251,191,36,.18), 0 0 50px rgba(251,191,36,.10); }
    .badge.newpay{ box-shadow: var(--glowB); }
    .badge b{ color: var(--text); }

    .heroCTA{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 14px;
    }

    /* ====== Trust strip ====== */
    .trustStrip{
      display:grid;
      grid-template-columns: repeat(4,1fr);
      gap: 10px;
      margin-top: 16px;
    }
    @media (max-width: 900px){ .trustStrip{ grid-template-columns: repeat(2,1fr);} }
    @media (max-width: 520px){ .trustStrip{ grid-template-columns: 1fr;} }

    .tbox{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      padding: 12px 12px;
      position:relative;
      overflow:hidden;
    }
    .tbox:before{
      content:"";
      position:absolute;
      inset:-1px;
      background: radial-gradient(260px 120px at 20% 0%, rgba(125,211,252,.12), transparent 62%);
      opacity:.8;
      pointer-events:none;
    }
    .tbox b{ display:block; font-size: 12.5px; letter-spacing:.2px; }
    .tbox span{ display:block; margin-top: 4px; font-size: 12px; color: var(--muted2); line-height:1.6; }

    /* ====== Section titles ====== */
    .sectionTitle{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:12px;
      padding: 18px 18px 10px;
    }
    .sectionTitle h3{ margin:0; font-size: 15px; letter-spacing:.3px; font-weight: 950; }
    .sectionTitle small{ color: var(--muted2); line-height:1.5; }

    /* ====== Products ====== */
    .products{
      display:grid;
      grid-template-columns: repeat(2,1fr);
      gap: 12px;
      padding: 10px 18px 18px;
    }
    @media (max-width: 720px){ .products{ grid-template-columns: 1fr; } }

    .p{
      border-radius: 22px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      overflow:hidden;
      position:relative;
      transform-style: preserve-3d;
      will-change: transform;
      transition: transform .18s var(--ease), border-color .18s var(--ease), box-shadow .18s var(--ease);
    }
    .p:hover{
      border-color: rgba(125,211,252,.28);
      box-shadow: var(--glowA), 0 22px 70px rgba(0,0,0,.55);
    }

    /* ✅ 圖片：800×800 仍然不突兀（不裁切、完整呈現） */
    .p .img{
      height: 230px;
      padding: 12px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        radial-gradient(360px 180px at 15% 0%, rgba(125,211,252,.16), transparent 62%),
        radial-gradient(320px 180px at 88% 12%, rgba(167,139,250,.12), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      position:relative;
      overflow:hidden;
    }
    @media (max-width: 720px){ .p .img{ height: 220px; } }

    .p .img img{
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 16px;
      background: rgba(0,0,0,.18);
      filter: saturate(1.05) contrast(1.06);
    }

    .tag{
      position:absolute;
      left: 12px;
      top: 12px;
      z-index: 2;
      padding: 7px 9px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.35);
      font-size: 11px;
      color: var(--muted);
      backdrop-filter: blur(10px);
    }

    .p .body{
      padding: 12px 12px 14px;
      display:flex;
      flex-direction:column;
      gap: 9px;
    }
    .name{
      font-weight: 980;
      letter-spacing:.2px;
      font-size: 14.5px;
      line-height:1.25;
    }
    .desc{
      color: var(--muted);
      font-size: 12.6px;
      line-height: 1.65;
    }
    .meta{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
      font-size: 12px;
      color: var(--muted);
    }
    .meta div{
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      padding: 9px 10px;
    }
    .opt{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    .opt label{
      display:flex;
      flex-direction:column;
      gap: 6px;
      font-size: 12px;
      color: var(--muted);
    }
    select{
      width:100%;
      padding: 10px 10px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline:none;
      font-weight: 900;
      transition: border-color .14s var(--ease), transform .14s var(--ease);
    }
    select:focus{ border-color: rgba(125,211,252,.45); }
    .row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      margin-top: 2px;
    }
    .price{
      font-weight: 980;
      letter-spacing:.2px;
    }
    .price small{ color: var(--muted2); font-weight: 800; }

    .note{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      padding: 10px 12px;
      font-size: 12px;
      color: var(--muted2);
      line-height: 1.65;
    }

    /* ====== Side panel ====== */
    .side .in h3{ margin:0; font-size: 15px; letter-spacing:.3px; }
    .muted{ color: var(--muted); line-height: 1.7; font-size: 13px; }
    .hr{ height: 1px; background: rgba(255,255,255,.10); margin: 14px 0; }

    .list{ display:flex; flex-direction:column; gap: 10px; }
    .li{
      display:flex;
      align-items:flex-start;
      gap: 10px;
      padding: 11px 12px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      backdrop-filter: blur(10px);
    }
    .dot{
      width: 10px; height:10px;
      border-radius: 999px;
      background: rgba(125,211,252,.92);
      box-shadow: 0 0 0 4px rgba(125,211,252,.14);
      margin-top: 4px;
      flex:0 0 auto;
    }
    .li b{ display:block; margin-bottom: 3px; letter-spacing:.2px; }
    .li span{ display:block; color: var(--muted); font-size: 12.5px; line-height: 1.6; }

    .infoGrid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .infoBox{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      padding: 12px 12px;
      line-height: 1.75;
      color: var(--muted);
      font-size: 12.6px;
    }
    .infoBox b{ color: var(--text); }
    .mono{ font-family: var(--mono); }

    /* ====== FAQ ====== */
    details{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      padding: 10px 12px;
    }
    summary{
      cursor:pointer;
      font-weight: 950;
      color: var(--text);
      letter-spacing:.2px;
      list-style:none;
    }
    summary::-webkit-details-marker{ display:none; }
    details p{
      margin: 8px 0 0;
      color: var(--muted);
      line-height:1.7;
      font-size: 12.6px;
    }

    /* ====== Reveal animation ====== */
    .reveal{
      opacity: 0;
      transform: translateY(14px);
      transition: opacity .7s var(--ease), transform .7s var(--ease);
    }
    .reveal.on{
      opacity: 1;
      transform: translateY(0);
    }

    /* ====== Cart Drawer ====== */
    .drawer{
      position: fixed;
      top: 0;
      right: 0;
      height: 100%;
      width: min(460px, 92vw);
      z-index: 80;
      transform: translateX(102%);
      transition: transform .34s var(--ease);
      background: rgba(5,6,11,.80);
      border-left: 1px solid rgba(255,255,255,.10);
      box-shadow: -18px 0 60px rgba(0,0,0,.55);
      backdrop-filter: blur(16px);
      display:flex;
      flex-direction:column;
    }
    .drawer.open{ transform: translateX(0); }
    .drawer .head{
      padding: 16px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .drawer .head b{ letter-spacing:.3px; }
    .drawer .body{
      padding: 12px 16px;
      overflow:auto;
      flex: 1 1 auto;
    }
    .drawer .foot{
      padding: 12px 16px;
      border-top: 1px solid rgba(255,255,255,.10);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      background: rgba(0,0,0,.20);
    }
    .cartItem{
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      padding: 12px 12px;
      margin-bottom: 10px;
      display:flex;
      justify-content:space-between;
      gap: 10px;
    }
    .cartItem .n{ font-weight: 980; letter-spacing:.2px; }
    .cartItem .m{ color: var(--muted2); font-size: 12px; margin-top: 4px; line-height:1.55; }
    .qty{
      display:flex;
      align-items:center;
      gap: 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      padding: 6px 8px;
      height: fit-content;
    }
    .qty button{
      width: 26px; height: 26px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--text);
      cursor:pointer;
      font-weight: 980;
      transition: transform .12s var(--ease), border-color .12s var(--ease);
    }
    .qty button:hover{ border-color: rgba(125,211,252,.35); transform: translateY(-1px); }
    .qty span{ min-width: 18px; text-align:center; font-family: var(--mono); font-size: 12px; }
    .total{ font-weight: 980; letter-spacing:.2px; }
    .total small{ color: var(--muted2); font-weight: 800; }

    /* Backdrop for drawer/modal */
    .backdrop{
      position: fixed;
      inset: 0;
      z-index: 70;
      background: rgba(0,0,0,.55);
      opacity: 0;
      pointer-events:none;
      transition: opacity .25s var(--ease);
    }
    .backdrop.on{
      opacity: 1;
      pointer-events:auto;
    }

    /* ====== Checkout Modal ====== */
    .modal{
      position: fixed;
      inset: 0;
      z-index: 90;
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
    }
    .modal.open{ display:flex; }
    .box{
      width: min(960px, 100%);
      border-radius: 28px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(5,6,11,.86);
      backdrop-filter: blur(18px);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .box:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(620px 260px at 20% 0%, rgba(125,211,252,.14), transparent 62%),
        radial-gradient(520px 260px at 86% 8%, rgba(167,139,250,.12), transparent 62%);
      pointer-events:none;
      opacity:.9;
    }
    .box .head{
      position:relative;
      padding: 14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .box .head b{ letter-spacing:.3px; }
    .box .body{
      position:relative;
      padding: 14px 16px 16px;
    }
    .summary{
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      padding: 12px 12px;
      color: var(--muted);
      line-height: 1.7;
      font-size: 12.8px;
    }

    .form{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 12px;
    }
    @media (max-width: 760px){ .form{ grid-template-columns: 1fr; } }
    label.field{
      display:flex;
      flex-direction:column;
      gap: 6px;
      font-size: 12px;
      color: var(--muted);
    }
    input, textarea{
      width:100%;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.22);
      color: var(--text);
      outline:none;
      font-weight: 900;
    }
    textarea{
      min-height: 92px;
      resize: vertical;
      font-weight: 750;
    }
    input:focus, textarea:focus{ border-color: rgba(125,211,252,.45); }
    .payBox{
      margin-top: 12px;
      border-radius: 20px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.14);
      padding: 12px 12px;
      color: var(--muted);
      line-height: 1.75;
      font-size: 12.7px;
    }
    .payBox b{ color: var(--text); }
    .hide{ display:none !important; }
    .tiny{ margin-top: 10px; font-size: 11.8px; color: var(--muted2); line-height: 1.75; }

    /* ====== Floating action ====== */
    .fab{
      position: fixed;
      left: 18px;
      bottom: 18px;
      z-index: 60;
      display:flex;
      gap: 10px;
      align-items:center;
      pointer-events:none;
    }
    .fab .btn{ pointer-events:auto; }
    @media (max-width: 720px){
      .fab{ left: 12px; bottom: 12px; }
    }

    /* ====== Motion preferences ====== */
    @media (prefers-reduced-motion: reduce){
      *{ animation: none !important; transition: none !important; scroll-behavior:auto !important; }
      #fx{ display:none; }
    }
  </style>
</head>

<body>
  <canvas id="fx" aria-hidden="true"></canvas>

  <header class="topbar">
    <div class="wrap">
      <div class="brand">
        <div class="mark" aria-hidden="true"></div>
        <div>
          <h1 id="storeTitle">貝樂創意工作室專業汽車LED大燈｜受邀下單專區</h1>
          <p>公開可下單｜付款：✅轉帳（可用）｜⚠️藍新科技支付（申請中）</p>
        </div>
      </div>

      <nav class="nav">
        <span class="pill">客服：<b id="csChip">bryan.deng1224@gmail.com</b></span>
        <button class="btn ghost" id="btnCart" type="button">購物車 <span class="kbd" id="cartCount">0</span></button>
        <button class="btn primary" type="button" onclick="openCheckout()">立即結帳</button>
      </nav>
    </div>
  </header>

  <div class="backdrop" id="backdrop" aria-hidden="true"></div>

  <main>
    <div class="wrap grid" style="padding-top:18px; padding-bottom:46px;">
      <!-- LEFT -->
      <section class="card reveal" data-reveal>
        <div class="hero">
          <div class="heroTop">
            <div>
              <h2>專業汽車LED大燈 亮度第一 品質第一</h2>
              <p>
                這是 <b>貝樂創意工作室</b> 的 專業汽車LED大燈 有任何問題 請與我們能聯繫~。<br/>
                <b>付款方式：</b>✅轉帳（可用）｜<b>⚠️藍新科技支付：</b>申請中（核准後將開放更多支付）。
              </p>
              <div class="heroBadges">
                <span class="badge good"><b>2–3 年保固</b>｜新款方案</span>
                <span class="badge warn"><b>老款促銷</b>｜NT$999</span>
                <span class="badge newpay"><b>藍新金流</b>｜申請中</span>
                <span class="badge"><b>7 種燈座</b>｜多元選擇</span>
              </div>
              <div class="heroCTA">
                <a class="btn primary" href="#products" onclick="smoothTo('products')">看商品 / 立即下單</a>
                <a class="btn ghost" href="#trust" onclick="smoothTo('trust')">商店資訊 / 公信力</a>
              </div>
            </div>
          </div>

          <div class="trustStrip" id="trust">
            <div class="tbox reveal" data-reveal>
              <b>付款清楚</b>
              <span>轉帳資訊於結帳顯示，並提示「轉帳後請聯繫」以便對帳出貨。</span>
            </div>
            <div class="tbox reveal" data-reveal>
              <b>客服可即時聯絡</b>
              <span>Email / 電話皆公開，有任何問題歡迎詢問。</span>
            </div>
            <div class="tbox reveal" data-reveal>
              <b>保固透明</b>
              <span>新款可選 2 年 / 3 年保固；老款促銷固定 1 年保固。</span>
            </div>
            <div class="tbox reveal" data-reveal>
              <b>規格選項完整</b>
              <span>H1 / H4 / H7 / H11 / 9005 / 9006 / 9012，一次選到位。</span>
            </div>
          </div>
        </div>

        <div class="sectionTitle anchor" id="products">
          <h3>商品列表（選燈座 / 選保固 / 直接下單）</h3>
          <small>亮度升級 全面強化 巔峰之作</small>
        </div>

        <div class="products" id="productList">
          <!-- 新款 250W -->
          <article class="p reveal" data-reveal data-tilt data-pid="k7ultra250">
            <div class="img">
              <div class="tag">新款｜K7-ULTRA 250W</div>
              <img loading="lazy" src="https://live.staticflickr.com/65535/55081652967_8951b713b0_c.jpg" alt="K7-ULTRA 250W 商品照" />
            </div>
            <div class="body">
              <div class="name">K7-ULTRA 250W（新款）</div>
              <div class="desc">高功率輸出方案，強化穩定性與散熱結構；可選 2年/3年保固。</div>
              <div class="meta">
                <div>功率：250W</div>
                <div>定位：新款主力</div>
              </div>
              <div class="opt">
                <label>燈座型號
                  <select id="bulb-k7ultra250"></select>
                </label>
                <label>保固 / 價格
                  <select id="plan-k7ultra250"></select>
                </label>
              </div>
              <div class="row">
                <div class="price" id="price-k7ultra250">NT$ 0 <small>/ 顆</small></div>
                <button class="btn primary" type="button" onclick="addToCartFromUI('k7ultra250')">加入購物車</button>
              </div>
              <div class="note" id="note-k7ultra250"></div>
            </div>
          </article>

          <!-- 新款 180W -->
          <article class="p reveal" data-reveal data-tilt data-pid="k7splus180">
            <div class="img">
              <div class="tag">新款｜K7S-PLUS 180W</div>
              <img loading="lazy" src="https://live.staticflickr.com/65535/55082810144_c76ec7230b_c.jpg" alt="K7S-PLUS 180W 商品照" />
            </div>
            <div class="body">
              <div class="name">K7S-PLUS 180W（新款）</div>
              <div class="desc">均衡輸出與穩定驅動，適合日常/長途需求；可選 2年/3年保固。</div>
              <div class="meta">
                <div>功率：180W</div>
                <div>定位：新款熱銷</div>
              </div>
              <div class="opt">
                <label>燈座型號
                  <select id="bulb-k7splus180"></select>
                </label>
                <label>保固 / 價格
                  <select id="plan-k7splus180"></select>
                </label>
              </div>
              <div class="row">
                <div class="price" id="price-k7splus180">NT$ 0 <small>/ 顆</small></div>
                <button class="btn primary" type="button" onclick="addToCartFromUI('k7splus180')">加入購物車</button>
              </div>
              <div class="note" id="note-k7splus180"></div>
            </div>
          </article>

          <!-- 老款 250W -->
          <article class="p reveal" data-reveal data-tilt data-pid="k7plus250_old">
            <div class="img">
              <div class="tag">促銷老款｜K7-PLUS 250W</div>
              <img loading="lazy" src="https://live.staticflickr.com/65535/55082551861_2baf16f6e6_c.jpg" alt="K7-PLUS 250W 老款 商品照" />
            </div>
            <div class="body">
              <div class="name">K7-PLUS 250W（老款促銷）</div>
              <div class="desc">促銷回饋價格，保固 1 年；適合想用更划算方案的買家。</div>
              <div class="meta">
                <div>功率：250W</div>
                <div>保固：1年</div>
              </div>
              <div class="opt">
                <label style="grid-column:1/-1;">燈座型號
                  <select id="bulb-k7plus250_old"></select>
                </label>
              </div>
              <div class="row">
                <div class="price" id="price-k7plus250_old">NT$ 999 <small>/ 顆</small></div>
                <button class="btn primary" type="button" onclick="addToCartFromUI('k7plus250_old')">加入購物車</button>
              </div>
              <div class="note" id="note-k7plus250_old"></div>
            </div>
          </article>

          <!-- 老款 180W -->
          <article class="p reveal" data-reveal data-tilt data-pid="k7s180_old">
            <div class="img">
              <div class="tag">促銷老款｜K7S 180W</div>
              <img loading="lazy" src="https://live.staticflickr.com/65535/55081653372_d814553213_c.jpg" alt="K7S 180W 老款 商品照" />
            </div>
            <div class="body">
              <div class="name">K7S 180W（老款促銷）</div>
              <div class="desc">促銷回饋價格，保固 1 年；經濟型升級選擇。</div>
              <div class="meta">
                <div>功率：180W</div>
                <div>保固：1年</div>
              </div>
              <div class="opt">
                <label style="grid-column:1/-1;">燈座型號
                  <select id="bulb-k7s180_old"></select>
                </label>
              </div>
              <div class="row">
                <div class="price" id="price-k7s180_old">NT$ 999 <small>/ 顆</small></div>
                <button class="btn primary" type="button" onclick="addToCartFromUI('k7s180_old')">加入購物車</button>
              </div>
              <div class="note" id="note-k7s180_old"></div>
            </div>
          </article>
        </div>

        <div class="in reveal" data-reveal>
          <div class="sectionTitle" style="padding:0 0 10px;">
            <h3>下單流程 / 付款 / 出貨（審核與客戶都安心）</h3>
            <small>老牌店家 品質保證</small>
          </div>

          <div class="list">
            <div class="li">
              <div class="dot"></div>
              <div>
                <b>1) 選燈座、選保固 → 加入購物車</b>
                <span>支援 H1/H4/H7/H11/9005/9006/9012。新款可選 2年/3年保固。</span>
              </div>
            </div>
            <div class="li">
              <div class="dot" style="background:rgba(251,191,36,.92); box-shadow:0 0 0 4px rgba(251,191,36,.14)"></div>
              <div>
                <b>2) 結帳付款：轉帳（可用）/ 藍新（申請中）</b>
                <span>現階段建議用「轉帳」完成下單；藍新核准後會開放更多支付方式。</span>
              </div>
            </div>
            <div class="li">
              <div class="dot" style="background:rgba(52,211,153,.88); box-shadow:0 0 0 4px rgba(52,211,153,.12)"></div>
              <div>
                <b>3) 轉帳完畢請聯繫我們</b>
                <span>請提供「訂單編號 + 轉帳末五碼/截圖」，我們確認入帳後安排出貨。</span>
              </div>
            </div>
          </div>

          <div class="hr"></div>

          <div class="sectionTitle" style="padding:0 0 10px;">
            <h3>FAQ</h3>
            <small>有疑慮請參考一下FAQ</small>
          </div>

          <div class="list">
            <details class="reveal" data-reveal>
              <summary>我不確定車款燈座怎麼選？</summary>
              <p>直接聯繫客服（Email/電話），提供車款年份與原廠燈座，我們會協助確認再下單。</p>
            </details>
            <details class="reveal" data-reveal>
              <summary>付款方式有哪些？</summary>
              <p>目前可用：轉帳。藍新科技支付正在申請中（核准後會開放更多線上付款方式）。</p>
            </details>
            <details class="reveal" data-reveal>
              <summary>轉帳後要怎麼通知？</summary>
              <p>請提供訂單編號與轉帳末五碼或截圖，Email 或電話聯繫皆可，我們確認後安排出貨。</p>
            </details>
          </div>

          <div class="hr"></div>

          <div class="sectionTitle" style="padding:0 0 10px;">
            <h3>客服 / 公司資訊</h3>
            <small>我們有工商登記 請您放心</small>
          </div>

          <div class="infoGrid">
            <div class="infoBox reveal" data-reveal>
              <b>客服聯絡</b><br/>
              Email：<span id="csEmailFooter">bryan.deng1224@gmail.com</span><br/>
              電話：<span id="csPhoneFooter">0980-556-730</span><br/>
              服務時間：週一至週六 10:00–21:00（可自行修改）
            </div>
            <div class="infoBox reveal" data-reveal>
              <b>公司資訊</b><br/>
              公司名稱：<span id="companyName">貝樂創意工作室</span><br/>
              統一編號：<span id="companyTax">93415481</span><br/>
              <span style="color:var(--muted2)">※ 下單完畢後 請與我們聯繫 感謝配合。</span>
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT -->
      <aside class="card side reveal" data-reveal>
        <div class="in">
          <h3>付款方式（重點提示）</h3>
          <div class="list" style="margin-top:10px;">
            <div class="li">
              <div class="dot" style="background:rgba(251,191,36,.92); box-shadow:0 0 0 4px rgba(251,191,36,.14)"></div>
              <div>
                <b>轉帳（目前可用）</b>
                <span>結帳選轉帳會顯示帳號資訊；轉帳後請聯繫客服提供訂單編號與末五碼/截圖。</span>
              </div>
            </div>
            <div class="li">
              <div class="dot" style="background:rgba(167,139,250,.88); box-shadow:0 0 0 4px rgba(167,139,250,.12)"></div>
              <div>
                <b>藍新科技支付（申請中）</b>
                <span>目前申請中未開通；若急用請先選轉帳完成下單。</span>
              </div>
            </div>
          </div>

          <div class="hr"></div>

          <h3>客服資訊</h3>
          <div class="infoBox">
            Email：<b id="csEmailSide">bryan.deng1224@gmail.com</b><br/>
            電話：<b id="csPhoneSide">0980-556-730</b>
          </div>

          <div class="hr"></div>

          <h3>燈座提醒</h3>
          <div class="infoBox">
            下單前請確認燈座：<b>H1 / H4 / H7 / H11 / 9005 / 9006 / 9012</b><br/>
            不確定就先聯繫客服，我們協助你確認最準。
          </div>

          <div class="hr"></div>

          <button class="btn primary" type="button" onclick="openCheckout()">前往結帳</button>
          <button class="btn ghost" type="button" onclick="smoothTo('products')">返回商品區</button>
        </div>
      </aside>
    </div>
  </main>

  <!-- Floating -->
  <div class="fab">
    <button class="btn ghost" type="button" onclick="smoothTo('products')">回商品</button>
    <button class="btn primary" type="button" onclick="toggleDrawer(true)">購物車 <span class="kbd" id="fabCount">0</span></button>
  </div>

  <!-- Cart Drawer -->
  <aside class="drawer" id="drawer" aria-label="購物車抽屜">
    <div class="head">
      <b>購物車</b>
      <div style="display:flex; gap:8px; align-items:center;">
        <button class="btn ghost" type="button" onclick="openCheckout()">結帳</button>
        <button class="btn" type="button" onclick="toggleDrawer(false)">關閉</button>
      </div>
    </div>
    <div class="body" id="cartBody"></div>
    <div class="foot">
      <div class="total">總計：<span id="cartTotal">NT$ 0</span> <small id="cartTotalHint"></small></div>
      <button class="btn primary" type="button" onclick="openCheckout()">前往結帳</button>
    </div>
  </aside>

  <!-- Checkout Modal -->
  <section class="modal" id="checkoutModal" aria-label="結帳視窗" role="dialog" aria-modal="true">
    <div class="box">
      <div class="head">
        <b>結帳｜付款方式：藍新科技支付 / 轉帳</b>
        <button class="btn" type="button" onclick="closeCheckout()">關閉</button>
      </div>
      <div class="body">
        <div class="summary" id="checkoutSummary"></div>

        <form id="orderForm" onsubmit="submitOrder(event)">
          <div class="form">
            <label class="field">收件人姓名
              <input required name="name" placeholder="例如：王小明" />
            </label>
            <label class="field">聯絡電話（必填）
              <input required name="phone" inputmode="tel" placeholder="例如：09XX-XXX-XXX" />
            </label>
            <label class="field">Email（建議）
              <input name="email" type="email" placeholder="例如：you@example.com" />
            </label>
            <label class="field">配送方式
              <select required name="ship" id="shipSelect">
                <option value="delivery">宅配</option>
                <option value="pickup">自取（請先聯繫確認）</option>
              </select>
            </label>

            <label class="field" style="grid-column:1/-1;">付款方式
              <select required name="payment" id="paymentSelect">
                <option value="newebpay">藍新科技支付（申請中）</option>
                <option value="bank" selected>轉帳（目前可用）</option>
              </select>
            </label>

            <label class="field" style="grid-column:1/-1;">收件地址（自取可填「自取」）
              <input required name="address" placeholder="例如：台中市○○區○○路○段○號" />
            </label>

            <label class="field" style="grid-column:1/-1;">備註（選填）
              <textarea name="note" placeholder="例如：車款年份/燈座資訊、希望出貨時間、安裝疑問等"></textarea>
            </label>
          </div>

          <div class="payBox" id="payBoxBank">
            <b>你選擇：轉帳（可用）</b><br/>
            轉帳帳號：<span class="kbd mono" id="bankAccountKbd">236035013281</span><br/>
            銀行：<span id="bankNameTxt">國泰世華 昌平分行</span>（代號：<span class="mono" id="bankCodeTxt">013</span>）<br/>
            戶名：<span id="bankHolderTxt">貝樂創意工作室 鄧凱丰</span><br/>
            <span style="color:var(--muted2)"><b>轉帳完畢後請聯繫我們</b>，提供「訂單編號 + 轉帳末五碼/截圖」，以便快速對帳出貨。</span>
          </div>

          <div class="payBox hide" id="payBoxNewebpay">
            <b>你選擇：藍新科技支付</b><br/>
            <span style="color:var(--w)">目前正在申請中，尚未開通線上付款。</span><br/>
            建議改選「轉帳」完成下單，或直接聯繫客服協助。
          </div>

          <div style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
            <button class="btn primary" type="submit">提交訂單</button>
            <button class="btn ghost" type="button" onclick="clearCart()">清空購物車</button>
          </div>

          <div class="tiny">
            提交訂單後：若選轉帳，會再次顯示帳號與「轉帳後請聯繫我們」指示；若選藍新，會提示申請中。
          </div>
        </form>

        <div class="infoBox" style="margin-top:12px;">
          <b>客服聯絡：</b><br/>
          Email：<span id="csEmailCheckout">bryan.deng1224@gmail.com</span> ｜ 電話：<span id="csPhoneCheckout">0980-556-730</span>
        </div>
      </div>
    </div>
  </section>

  <script>
    /**********************
     * 店家資訊（依你提供）
     **********************/
    const SHOP = {
      storeTitle: "貝樂創意工作室｜專業汽車LED大燈",
      csEmail: "bryan.deng1224@gmail.com",
      csPhone: "0980-556-730",
      companyName: "貝樂創意工作室",
      taxId: "93415481",
      bank: {
        account: "236035013281",
        name: "國泰世華 昌平分行",
        code: "013",
        holder: "貝樂創意工作室 鄧凱丰",
        note: "轉帳完畢後請聯繫我們，提供訂單編號 + 轉帳末五碼/截圖，以便快速對帳出貨。"
      }
    };

    // 寫入頁面
    document.getElementById("storeTitle").textContent = SHOP.storeTitle;
    document.getElementById("csChip").textContent = SHOP.csEmail;
    document.getElementById("csEmailFooter").textContent = SHOP.csEmail;
    document.getElementById("csPhoneFooter").textContent = SHOP.csPhone;
    document.getElementById("csEmailSide").textContent = SHOP.csEmail;
    document.getElementById("csPhoneSide").textContent = SHOP.csPhone;
    document.getElementById("csEmailCheckout").textContent = SHOP.csEmail;
    document.getElementById("csPhoneCheckout").textContent = SHOP.csPhone;
    document.getElementById("companyName").textContent = SHOP.companyName;
    document.getElementById("companyTax").textContent = SHOP.taxId;

    document.getElementById("bankAccountKbd").textContent = SHOP.bank.account;
    document.getElementById("bankNameTxt").textContent = SHOP.bank.name;
    document.getElementById("bankCodeTxt").textContent = SHOP.bank.code;
    document.getElementById("bankHolderTxt").textContent = SHOP.bank.holder;

    /**********************
     * Smooth scroll helper
     **********************/
    function smoothTo(id){
      const el = document.getElementById(id);
      if(!el) return;
      el.scrollIntoView({behavior:"smooth", block:"start"});
    }

    /**********************
     * 商品/選項（依你指定）
     **********************/
    const BULB_OPTIONS = ["H1","H4","H7","H11","9005","9006","9012"];

    const PRODUCTS = {
      k7ultra250: {
        id:"k7ultra250",
        name:"K7-ULTRA 250W（新款）",
        power:"250W",
        isNew:true,
        plans:{
          "2y": { label:"2年保固", price:1599 },
          "3y": { label:"3年保固", price:1799 }
        },
        defaultPlan:"2y",
        desc:"新款 250W｜可選 2/3 年保固"
      },
      k7splus180: {
        id:"k7splus180",
        name:"K7S-PLUS 180W（新款）",
        power:"180W",
        isNew:true,
        plans:{
          "2y": { label:"2年保固", price:1099 },
          "3y": { label:"3年保固", price:1299 }
        },
        defaultPlan:"2y",
        desc:"新款 180W｜可選 2/3 年保固"
      },
      k7plus250_old: {
        id:"k7plus250_old",
        name:"K7-PLUS 250W（老款促銷）",
        power:"250W",
        isNew:false,
        fixed:{ label:"1年保固", price:999 },
        desc:"老款促銷｜1 年保固"
      },
      k7s180_old: {
        id:"k7s180_old",
        name:"K7S 180W（老款促銷）",
        power:"180W",
        isNew:false,
        fixed:{ label:"1年保固", price:999 },
        desc:"老款促銷｜1 年保固"
      }
    };

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;")
        .replaceAll('"',"&quot;").replaceAll("'","&#039;");
    }
    function money(n){ return "NT$ " + (n||0).toLocaleString("zh-Hant-TW"); }
    function makeKey(pid, bulb, plan){ return `${pid}::${bulb}::${plan || ""}`; }
    function parseKey(key){
      const [pid, bulb, plan] = key.split("::");
      return {pid, bulb, plan: plan || ""};
    }

    function fillBulbSelect(selectEl){
      selectEl.innerHTML = "";
      BULB_OPTIONS.forEach(v=>{
        const o=document.createElement("option");
        o.value=v; o.textContent=v;
        selectEl.appendChild(o);
      });
    }

    function fillPlanSelect(pid){
      const p = PRODUCTS[pid];
      const planEl = document.getElementById(`plan-${pid}`);
      if(!planEl) return;

      if(!p.isNew){
        planEl.innerHTML = "";
        const o=document.createElement("option");
        o.value="1y";
        o.textContent = `${p.fixed.label}｜${money(p.fixed.price)}`;
        planEl.appendChild(o);
        planEl.disabled = true;
        return;
      }
      planEl.innerHTML = "";
      Object.entries(p.plans).forEach(([k, v])=>{
        const o=document.createElement("option");
        o.value = k;
        o.textContent = `${v.label}｜${money(v.price)}`;
        planEl.appendChild(o);
      });
      planEl.value = p.defaultPlan;
    }

    function getSelectedVariant(pid){
      const p = PRODUCTS[pid];
      const bulb = document.getElementById(`bulb-${pid}`).value;
      let plan = "";
      let price = 0;
      let planLabel = "";

      if(p.isNew){
        plan = document.getElementById(`plan-${pid}`).value;
        price = p.plans[plan].price;
        planLabel = p.plans[plan].label;
      }else{
        plan = "1y";
        price = p.fixed.price;
        planLabel = p.fixed.label;
      }
      return {pid, bulb, plan, price, planLabel};
    }

    function updateProductUI(pid){
      const p = PRODUCTS[pid];
      const priceEl = document.getElementById(`price-${pid}`);
      const noteEl = document.getElementById(`note-${pid}`);
      const v = getSelectedVariant(pid);

      if(priceEl) priceEl.innerHTML = `${money(v.price)} <small>/ 顆</small>`;
      if(noteEl){
        noteEl.innerHTML = `
          <b>已選擇：</b>
          燈座 <span class="kbd mono">${escapeHtml(v.bulb)}</span>｜
          ${escapeHtml(v.planLabel)}｜
          ${escapeHtml(p.power)}
          <br/>
          <span style="color:rgba(246,250,255,.55)">${escapeHtml(p.desc)}</span>
        `;
      }
    }

    function initProducts(){
      Object.keys(PRODUCTS).forEach(pid=>{
        const bulbEl = document.getElementById(`bulb-${pid}`);
        if(bulbEl){
          fillBulbSelect(bulbEl);
          bulbEl.addEventListener("change", ()=>updateProductUI(pid));
        }
        fillPlanSelect(pid);
        const planEl = document.getElementById(`plan-${pid}`);
        if(planEl && !planEl.disabled){
          planEl.addEventListener("change", ()=>updateProductUI(pid));
        }
        updateProductUI(pid);
      });
    }
    initProducts();

    /**********************
     * Cart (localStorage)
     **********************/
    const drawer = document.getElementById("drawer");
    const backdrop = document.getElementById("backdrop");
    const cartBody = document.getElementById("cartBody");
    const cartCount = document.getElementById("cartCount");
    const fabCount = document.getElementById("fabCount");
    const cartTotal = document.getElementById("cartTotal");
    const cartTotalHint = document.getElementById("cartTotalHint");
    const CART_KEY = "BLLED_CART_V3";

    function loadCart(){
      try{ return JSON.parse(localStorage.getItem(CART_KEY) || "{}"); }
      catch{ return {}; }
    }
    function saveCart(c){
      localStorage.setItem(CART_KEY, JSON.stringify(c));
      renderCart();
    }

    function addToCartFromUI(pid){
      const v = getSelectedVariant(pid);
      const key = makeKey(v.pid, v.bulb, v.plan);
      const c = loadCart();
      c[key] = (c[key] || 0) + 1;
      saveCart(c);
      toggleDrawer(true);
    }

    function setQty(key, qty){
      const c = loadCart();
      if(qty <= 0) delete c[key];
      else c[key] = qty;
      saveCart(c);
    }

    function clearCart(){
      localStorage.setItem(CART_KEY, JSON.stringify({}));
      renderCart();
    }

    function calcCart(c){
      let items=[], sum=0, count=0;
      Object.entries(c).forEach(([key, qty])=>{
        const {pid, bulb, plan} = parseKey(key);
        const p = PRODUCTS[pid]; if(!p) return;

        let unit=0, planLabel="";
        if(p.isNew){
          unit = p.plans[plan]?.price ?? 0;
          planLabel = p.plans[plan]?.label ?? "";
        }else{
          unit = p.fixed.price;
          planLabel = p.fixed.label;
        }
        const line = unit * qty;
        sum += line;
        count += qty;
        items.push({key, pid, bulb, plan, planLabel, unit, qty, line, p});
      });
      return {items, sum, count};
    }

    function renderCart(){
      const c = loadCart();
      const {items, sum, count} = calcCart(c);
      cartCount.textContent = count;
      fabCount.textContent = count;

      cartBody.innerHTML = "";
      if(items.length === 0){
        cartBody.innerHTML = `<div class="muted">購物車目前是空的。請先選燈座/保固後加入商品。</div>`;
        cartTotal.textContent = money(0);
        cartTotalHint.textContent = "";
        return;
      }

      items.forEach(it=>{
        const div = document.createElement("div");
        div.className = "cartItem";
        div.innerHTML = `
          <div style="max-width:72%;">
            <div class="n">${escapeHtml(it.p.name)}</div>
            <div class="m">燈座：<span class="kbd mono">${escapeHtml(it.bulb)}</span>｜${escapeHtml(it.planLabel)}｜${escapeHtml(it.p.power)}</div>
            <div class="m">單價：<b style="color:var(--text)">${money(it.unit)}</b> ｜ 小計：<b style="color:var(--text)">${money(it.line)}</b></div>
          </div>
          <div style="display:flex; flex-direction:column; gap:8px; align-items:flex-end;">
            <div class="qty">
              <button type="button" onclick="setQty(${JSON.stringify(it.key)}, ${it.qty-1})">−</button>
              <span>${it.qty}</span>
              <button type="button" onclick="setQty(${JSON.stringify(it.key)}, ${it.qty+1})">＋</button>
            </div>
            <button class="btn ghost" type="button" onclick="setQty(${JSON.stringify(it.key)}, 0)">移除</button>
          </div>
        `;
        cartBody.appendChild(div);
      });

      cartTotal.textContent = money(sum);
      cartTotalHint.textContent = `（共 ${count} 件）`;
    }

    function toggleDrawer(open){
      if(open){
        drawer.classList.add("open");
        backdrop.classList.add("on");
      }else{
        drawer.classList.remove("open");
        if(!document.getElementById("checkoutModal").classList.contains("open")){
          backdrop.classList.remove("on");
        }
      }
    }
    document.getElementById("btnCart").addEventListener("click", ()=> toggleDrawer(!drawer.classList.contains("open")));
    backdrop.addEventListener("click", ()=>{
      toggleDrawer(false);
      closeCheckout();
    });

    renderCart();

    /**********************
     * Checkout
     **********************/
    const checkoutModal = document.getElementById("checkoutModal");
    const checkoutSummary = document.getElementById("checkoutSummary");
    const paymentSelect = document.getElementById("paymentSelect");
    const payBoxBank = document.getElementById("payBoxBank");
    const payBoxNewebpay = document.getElementById("payBoxNewebpay");

    function syncPaymentUI(){
      const v = paymentSelect.value;
      if(v === "bank"){
        payBoxBank.classList.remove("hide");
        payBoxNewebpay.classList.add("hide");
      }else{
        payBoxNewebpay.classList.remove("hide");
        payBoxBank.classList.add("hide");
      }
    }
    paymentSelect.addEventListener("change", syncPaymentUI);

    function openCheckout(){
      const c = loadCart();
      const {items, sum} = calcCart(c);
      if(items.length === 0){ toggleDrawer(true); return; }

      const lines = items.map(it =>
        `• ${escapeHtml(it.p.name)}（燈座 ${escapeHtml(it.bulb)}｜${escapeHtml(it.planLabel)}） × ${it.qty}（${money(it.line)}）`
      ).join("<br/>");

      checkoutSummary.innerHTML = `
        <b style="color:var(--text)">訂單摘要</b><br/>
        ${lines}<br/>
        <div style="margin-top:8px;"><b>總計：</b>${money(sum)}</div>
        <div style="margin-top:10px; color:rgba(246,250,255,.55); line-height:1.7;">
          付款方式：<b>轉帳（可用）</b>｜<b>藍新科技支付（申請中）</b><br/>
          ※ 建議先選「轉帳」完成下單；轉帳完畢後請聯繫我們。
        </div>
      `;

      checkoutModal.classList.add("open");
      backdrop.classList.add("on");
      syncPaymentUI();
      toggleDrawer(false);
    }

    function closeCheckout(){
      checkoutModal.classList.remove("open");
      if(!drawer.classList.contains("open")){
        backdrop.classList.remove("on");
      }
    }

    function submitOrder(e){
      e.preventDefault();
      const c = loadCart();
      const {items, sum} = calcCart(c);
      if(items.length === 0){ closeCheckout(); return; }

      const fd = new FormData(document.getElementById("orderForm"));
      const orderId = "BL" + Date.now().toString().slice(-10);

      const name = (fd.get("name")||"").toString().trim();
      const phone = (fd.get("phone")||"").toString().trim();
      const email = (fd.get("email")||"").toString().trim();
      const ship = (fd.get("ship")||"").toString().trim();
      const payment = (fd.get("payment")||"").toString().trim();
      const address = (fd.get("address")||"").toString().trim();
      const note = (fd.get("note")||"").toString().trim();

      const itemText = items.map(it => `${it.p.name}（${it.bulb}/${it.planLabel}）×${it.qty}`).join("、");

      if(payment === "bank"){
        const orderText =
`【貝樂創意工作室專業汽車LED大燈｜訂單資訊】
訂單編號：${orderId}
收件人：${name}
電話：${phone}
Email：${email || "（未填）"}
配送：${ship === "pickup" ? "自取" : "宅配"}
地址：${address}
備註：${note || "（無）"}

商品：${itemText}
總計：${money(sum)}

【轉帳資訊】
轉帳帳號：${SHOP.bank.account}
銀行：${SHOP.bank.name}（代號：${SHOP.bank.code}）
戶名：${SHOP.bank.holder}

【重要】
${SHOP.bank.note}

客服：${SHOP.csEmail} / ${SHOP.csPhone}`;

        const mailSubject = encodeURIComponent(`訂單 ${orderId}｜已轉帳/待確認`);
        const mailBody = encodeURIComponent(orderText);
        const mailto = `mailto:${encodeURIComponent(SHOP.csEmail)}?subject=${mailSubject}&body=${mailBody}`;

        checkoutSummary.innerHTML = `
          <b style="color:var(--c)">訂單已建立</b><br/>
          訂單編號：<span class="kbd mono">${orderId}</span>｜總計：<b>${money(sum)}</b><br/>
          <div class="hr"></div>

          <b>你選擇：轉帳（請先轉帳，再聯繫我們）</b><br/>
          轉帳帳號：<span class="kbd mono">${escapeHtml(SHOP.bank.account)}</span><br/>
          銀行：${escapeHtml(SHOP.bank.name)}（代號：<span class="mono">${escapeHtml(SHOP.bank.code)}</span>）<br/>
          戶名：${escapeHtml(SHOP.bank.holder)}<br/>

          <div style="margin-top:10px; color:rgba(246,250,255,.55); line-height:1.7;">
            <b>轉帳完畢後請聯繫我們</b>：提供「訂單編號 + 轉帳末五碼/截圖」以便快速對帳出貨。
          </div>

          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
            <button class="btn primary" type="button" onclick="copyText(${JSON.stringify(orderText)})">複製訂單/轉帳資訊</button>
            <a class="btn" href="${mailto}">用 Email 聯繫我們</a>
          </div>
        `;
      }else{
        checkoutSummary.innerHTML = `
          <b style="color:var(--w)">你選擇：藍新科技支付</b><br/>
          <span style="color:rgba(246,250,255,.55); line-height:1.7;">
            目前藍新科技支付正在申請中，尚未開通線上付款。<br/>
            建議改選 <b>轉帳</b> 完成下單，或直接聯繫客服協助。
          </span>
          <div class="hr"></div>
          <b>客服聯絡</b><br/>
          Email：${escapeHtml(SHOP.csEmail)} ｜ 電話：${escapeHtml(SHOP.csPhone)}
        `;
      }

      console.log("Order:", {orderId, name, phone, email, ship, payment, address, note, items, sum});
      clearCart();
      document.getElementById("orderForm").reset();
      paymentSelect.value = "bank";
      syncPaymentUI();
    }

    async function copyText(text){
      try{ await navigator.clipboard.writeText(text); alert("已複製：訂單與轉帳資訊"); }
      catch{
        const ta=document.createElement("textarea");
        ta.value=text; document.body.appendChild(ta);
        ta.select(); document.execCommand("copy");
        document.body.removeChild(ta);
        alert("已複製：訂單與轉帳資訊");
      }
    }

    window.addEventListener("keydown", (e)=>{
      if(e.key === "Escape"){
        closeCheckout();
        toggleDrawer(false);
      }
    });

    /**********************
     * Reveal animations
     **********************/
    (function(){
      const items = document.querySelectorAll("[data-reveal]");
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(en=>{
          if(en.isIntersecting){
            en.target.classList.add("on");
            io.unobserve(en.target);
          }
        });
      }, { threshold: .12 });
      items.forEach(el=>{
        el.classList.add("reveal");
        io.observe(el);
      });
    })();

    /**********************
     * 3D tilt (cards)
     **********************/
    (function(){
      const prefersReduce = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      if(prefersReduce) return;

      const cards = document.querySelectorAll("[data-tilt]");
      cards.forEach(card=>{
        let raf = null;
        const strength = 10;

        function onMove(e){
          const r = card.getBoundingClientRect();
          const cx = r.left + r.width/2;
          const cy = r.top + r.height/2;
          const dx = (e.clientX - cx) / (r.width/2);
          const dy = (e.clientY - cy) / (r.height/2);
          const rx = (-dy) * strength;
          const ry = (dx) * strength;

          if(raf) cancelAnimationFrame(raf);
          raf = requestAnimationFrame(()=>{
            card.style.transform = `perspective(900px) rotateX(${rx}deg) rotateY(${ry}deg) translateY(-1px)`;
          });
        }

        function onLeave(){
          if(raf) cancelAnimationFrame(raf);
          card.style.transform = "";
        }

        card.addEventListener("pointermove", onMove);
        card.addEventListener("pointerleave", onLeave);
      });
    })();

    /**********************
     * Neon particles canvas FX
     **********************/
    (function(){
      const prefersReduce = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      if(prefersReduce) return;

      const canvas = document.getElementById("fx");
      const ctx = canvas.getContext("2d", { alpha:true });

      let w=0,h=0, dpr=1;
      let particles=[];
      let running=true;

      const isMobile = matchMedia("(max-width: 720px)").matches;
      const baseCount = isMobile ? 46 : 78;

      function resize(){
        dpr = Math.min(window.devicePixelRatio || 1, 2);
        w = canvas.width = Math.floor(innerWidth * dpr);
        h = canvas.height = Math.floor(innerHeight * dpr);
        canvas.style.width = innerWidth + "px";
        canvas.style.height = innerHeight + "px";
      }

      function rand(min,max){ return min + Math.random()*(max-min); }

      function make(){
        particles = Array.from({length: baseCount}, ()=>({
          x: rand(0,w), y: rand(0,h),
          vx: rand(-.35,.35)*dpr,
          vy: rand(-.35,.35)*dpr,
          r: rand(1.1,2.2)*dpr,
          t: rand(0,Math.PI*2),
          c: Math.random()<.34 ? "A" : (Math.random()<.5 ? "B" : "C")
        }));
      }

      function colorOf(p, alpha){
        if(p.c==="A") return `rgba(125,211,252,${alpha})`;
        if(p.c==="B") return `rgba(167,139,250,${alpha})`;
        return `rgba(52,211,153,${alpha})`;
      }

      function step(){
        if(!running) return;
        ctx.clearRect(0,0,w,h);

        // soft vignette glow
        const g = ctx.createRadialGradient(w*0.5,h*0.45, 0, w*0.5,h*0.55, Math.max(w,h)*0.55);
        g.addColorStop(0, "rgba(255,255,255,.02)");
        g.addColorStop(1, "rgba(0,0,0,0)");
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);

        for(const p of particles){
          p.t += 0.01;
          p.x += p.vx + Math.sin(p.t)*0.02*dpr;
          p.y += p.vy + Math.cos(p.t)*0.02*dpr;

          if(p.x<0) p.x = w;
          if(p.x>w) p.x = 0;
          if(p.y<0) p.y = h;
          if(p.y>h) p.y = 0;
        }

        // lines
        for(let i=0;i<particles.length;i++){
          for(let j=i+1;j<particles.length;j++){
            const a = particles[i], b = particles[j];
            const dx = a.x-b.x, dy = a.y-b.y;
            const dist = Math.sqrt(dx*dx+dy*dy);
            const maxD = (isMobile ? 140 : 170) * dpr;
            if(dist < maxD){
              const alpha = (1 - dist/maxD) * 0.18;
              ctx.strokeStyle = colorOf(a, alpha);
              ctx.lineWidth = 1*dpr;
              ctx.beginPath();
              ctx.moveTo(a.x,a.y);
              ctx.lineTo(b.x,b.y);
              ctx.stroke();
            }
          }
        }

        // dots
        for(const p of particles){
          ctx.fillStyle = colorOf(p, 0.30);
          ctx.beginPath();
          ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
          ctx.fill();
        }

        requestAnimationFrame(step);
      }

      // pause when tab hidden
      document.addEventListener("visibilitychange", ()=>{
        running = !document.hidden;
        if(running) requestAnimationFrame(step);
      });

      window.addEventListener("resize", ()=>{
        resize();
        make();
      });

      resize();
      make();
      requestAnimationFrame(step);
    })();
  </script>
</body>
</html>
